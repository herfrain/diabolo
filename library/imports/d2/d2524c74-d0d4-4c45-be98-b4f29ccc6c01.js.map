{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\backgrounds.js"],"names":["cc","Class","extends","Component","properties","backgrounds","camera","default","type","Node","onLoad","node","children","start","update","dt","y","parent","height","length","log","loader","loadRes","err","resource","bg","instantiate","preBg","x","addChild","i","isValid","destroy"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAY,IADJ;AAERC,gBAAO;AACHC,qBAAQ,IADL;AAEHC,kBAAKR,GAAGS;AAFL;AAFC,KAHP;;AAWL;;AAEAC,UAbK,oBAaK;AACN,aAAKL,WAAL,GAAiB,KAAKM,IAAL,CAAUC,QAA3B;AACH,KAfI;AAiBLC,SAjBK,mBAiBI,CAER,CAnBI;AAqBLC,UArBK,kBAqBGC,EArBH,EAqBO;AAAA;;AACR;AACA,YAAG,KAAKT,MAAL,CAAYU,CAAZ,GAAc,KAAKV,MAAL,CAAYW,MAAZ,CAAmBC,MAAjC,GAAwC,KAAKb,WAAL,CAAiB,KAAKA,WAAL,CAAiBc,MAAjB,GAAwB,CAAzC,EAA4CH,CAAvF,EAAyF;AACrFhB,eAAGoB,GAAH,CAAO,MAAP;AACA;AACApB,eAAGqB,MAAH,CAAUC,OAAV,CAAkB,mBAAlB,EAAuC,UAACC,GAAD,EAAMC,QAAN,EAAiB;AACpD,oBAAGD,GAAH,EAAO;AAAE;AAAS;AAClB,oBAAIE,KAAGzB,GAAG0B,WAAH,CAAeF,QAAf,CAAP,CAFoD,CAErB;AAC/B,oBAAIG,QAAM,MAAKtB,WAAL,CAAiB,MAAKA,WAAL,CAAiBc,MAAjB,GAAwB,CAAzC,CAAV;AACAM,mBAAGT,CAAH,GAAKW,MAAMX,CAAN,GAAQW,MAAMT,MAAnB,CAJoD,CAI3B;AACzBO,mBAAGG,CAAH,GAAK,CAAL;AACA,sBAAKjB,IAAL,CAAUkB,QAAV,CAAmBJ,EAAnB,EANoD,CAM9B;AAEzB,aARD;AASA;AACAzB,eAAGqB,MAAH,CAAUC,OAAV,CAAkB,oBAAlB,EAAwC,UAACC,GAAD,EAAMC,QAAN,EAAiB;AACrD,oBAAGD,GAAH,EAAO;AAAE;AAAS;AAClB,oBAAIE,KAAGzB,GAAG0B,WAAH,CAAeF,QAAf,CAAP,CAFqD,CAEtB;AAC/B,oBAAIG,QAAM,MAAKtB,WAAL,CAAiB,MAAKA,WAAL,CAAiBc,MAAjB,GAAwB,CAAzC,CAAV;AACAM,mBAAGT,CAAH,GAAKW,MAAMX,CAAN,GAAQW,MAAMT,MAAnB,CAJqD,CAI5B;AACzBO,mBAAGG,CAAH,GAAK,CAAL;AACA,sBAAKjB,IAAL,CAAUkB,QAAV,CAAmBJ,EAAnB,EANqD,CAM/B;AACzB,aAPD;AAQH;AACD;AACA,aAAI,IAAIK,IAAE,CAAV,EAAYA,IAAE,KAAKzB,WAAL,CAAiBc,MAA/B,EAAsCW,GAAtC,EAA0C;AACtC,gBAAG,KAAKzB,WAAL,CAAiByB,CAAjB,EAAoBC,OAAvB,EAA+B;AAC3B,oBAAG,KAAK1B,WAAL,CAAiByB,CAAjB,EAAoBd,CAApB,GAAsB,KAAKX,WAAL,CAAiByB,CAAjB,EAAoBZ,MAApB,GAA2B,CAAjD,GAAmD,KAAKZ,MAAL,CAAYU,CAAZ,GAAc,KAAKV,MAAL,CAAYW,MAAZ,CAAmBC,MAAnB,GAA0B,CAA9F,EAAgG;AAAC;AAC7F;AACA,yBAAKb,WAAL,CAAiByB,CAAjB,EAAoBE,OAApB;AACH;AACJ;AACJ;AACJ;AAtDI,CAAT","file":"backgrounds.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        backgrounds:null,\r\n        camera:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.backgrounds=this.node.children\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        //动态加载背景，达到背景循环的效果\r\n        if(this.camera.y+this.camera.parent.height>this.backgrounds[this.backgrounds.length-1].y){\r\n            cc.log(\"生成背景\")\r\n            //第一幅背景\r\n            cc.loader.loadRes('background.prefab', (err, resource)=>{\r\n                if(err){ return; }\r\n                var bg=cc.instantiate(resource)//克隆实例\r\n                var preBg=this.backgrounds[this.backgrounds.length-1]\r\n                bg.y=preBg.y+preBg.height//从最后一个背景的上面\r\n                bg.x=0\r\n                this.node.addChild(bg)//添加背景\r\n                \r\n            });\r\n            //第二幅背景\r\n            cc.loader.loadRes('background2.prefab', (err, resource)=>{\r\n                if(err){ return; }\r\n                var bg=cc.instantiate(resource)//克隆实例\r\n                var preBg=this.backgrounds[this.backgrounds.length-1]\r\n                bg.y=preBg.y+preBg.height//从最后一个背景的上面\r\n                bg.x=0\r\n                this.node.addChild(bg)//添加背景\r\n            });\r\n        }\r\n        //消除背景\r\n        for(var i=0;i<this.backgrounds.length;i++){\r\n            if(this.backgrounds[i].isValid){\r\n                if(this.backgrounds[i].y+this.backgrounds[i].height/2<this.camera.y-this.camera.parent.height/2){//低于摄像机下边界\r\n                    // cc.log(2)\r\n                    this.backgrounds[i].destroy()\r\n                }\r\n            }\r\n        }\r\n    },\r\n});\r\n"]}